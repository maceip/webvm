FROM --platform=i386 i386/debian:bookworm
ARG DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get -y upgrade && \
	apt-get install -y apt-utils ca-certificates curl g++ gcc git make \
	nano nodejs npm openssl procps python3 python3-pip readline-common \
	sensible-utils vim wget less bash-completion build-essential \
	ripgrep jq xterm

# Create user for Claude Code
RUN useradd -m user && echo "user:password" | chpasswd
RUN echo 'root:password' | chpasswd

# Install Claude Code globally
RUN npm install -g @anthropic/claude-code

# Set up working environment
WORKDIR /home/user/
ENV HOME="/home/user" TERM="xterm" USER="user" SHELL="/bin/bash" EDITOR="vim" LANG="en_US.UTF-8" LC_ALL="C"

# Create startup script for Claude Code
RUN echo '#!/bin/bash\nxterm -e claude-code &' > /usr/local/bin/start-claude && \
    chmod +x /usr/local/bin/start-claude

CMD [ "/usr/local/bin/start-claude" ]
